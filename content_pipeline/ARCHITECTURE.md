# System Architecture - Content Intelligence Pipeline

## ğŸ—ï¸ High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CONTENT INTELLIGENCE PIPELINE                    â”‚
â”‚                              (MVP v1.0)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Competitor URL  â”‚ â—„â”€â”€â”€ Input
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PIPELINE STAGES                              â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Stage 1: Content Extraction                                  â”‚  â”‚
â”‚  â”‚  â€¢ Jina AI Reader (primary)                                  â”‚  â”‚
â”‚  â”‚  â€¢ Trafilatura (fallback)                                    â”‚  â”‚
â”‚  â”‚  Output: Clean markdown + metadata                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Stage 2: Content Intelligence Analysis                       â”‚  â”‚
â”‚  â”‚  â€¢ Gemini 2.0 Flash (content analysis)                       â”‚  â”‚
â”‚  â”‚  â€¢ SerpAPI (keyword research)                                â”‚  â”‚
â”‚  â”‚  â€¢ LLM keyword extraction                                    â”‚  â”‚
â”‚  â”‚  Output: Content brief with topics, keywords, gaps           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Stage 3: Safety & Ethics Gate                                â”‚  â”‚
â”‚  â”‚  â€¢ Copyright risk assessment                                 â”‚  â”‚
â”‚  â”‚  â€¢ Content fingerprinting (embeddings)                       â”‚  â”‚
â”‚  â”‚  â€¢ Sensitive topic detection                                 â”‚  â”‚
â”‚  â”‚  Decision: RED/YELLOW/GREEN                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                       â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                    â”‚   RED FLAG?     â”‚                             â”‚
â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                         â”‚ Yes  â”‚ No                                â”‚
â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”   â”‚                                   â”‚
â”‚                    â”‚ HALT  â”‚   â”‚                                   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                                   â”‚
â”‚                                â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Stage 4: Brand Voice RAG (one-time setup)                    â”‚ â”‚
â”‚  â”‚  â€¢ Load Sendmarc blogs                                       â”‚ â”‚
â”‚  â”‚  â€¢ Chunk + embed                                             â”‚ â”‚
â”‚  â”‚  â€¢ Store in ChromaDB                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Stage 5: Outline Generation                                  â”‚ â”‚
â”‚  â”‚  â€¢ Retrieve 3-5 brand examples (RAG)                         â”‚ â”‚
â”‚  â”‚  â€¢ Gemini 2.0 Flash + context                                â”‚ â”‚
â”‚  â”‚  Output: Structured H1/H2/H3 outline                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Stage 6: Full Draft Generation                               â”‚ â”‚
â”‚  â”‚  â€¢ Retrieve brand examples (RAG)                             â”‚ â”‚
â”‚  â”‚  â€¢ Gemini 2.0 Flash long-form generation                     â”‚ â”‚
â”‚  â”‚  Output: Complete markdown article (1500-2500 words)         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Stage 7: Quality Assurance & Validation                      â”‚ â”‚
â”‚  â”‚  â€¢ Plagiarism check (embeddings similarity)                  â”‚ â”‚
â”‚  â”‚  â€¢ SEO scoring (6 components)                                â”‚ â”‚
â”‚  â”‚  â€¢ Readability analysis (Flesch)                             â”‚ â”‚
â”‚  â”‚  â€¢ Fact checking (LLM)                                       â”‚ â”‚
â”‚  â”‚  Output: Quality report with pass/fail                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                                      â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                    â”‚   BLOCKED?      â”‚                            â”‚
â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                         â”‚ Yes  â”‚ No                               â”‚
â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”   â”‚                                  â”‚
â”‚                    â”‚ HALT  â”‚   â”‚                                  â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                                  â”‚
â”‚                                â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Stage 8: HTML Structuring & Production Formatting            â”‚ â”‚
â”‚  â”‚  â€¢ Markdown â†’ HTML                                           â”‚ â”‚
â”‚  â”‚  â€¢ Apply Jinja2 template                                     â”‚ â”‚
â”‚  â”‚  â€¢ Generate Schema.org markup                                â”‚ â”‚
â”‚  â”‚  â€¢ Add meta tags (OpenGraph, Twitter)                        â”‚ â”‚
â”‚  â”‚  Output: Production-ready HTML file                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage 9: Human Review Dashboard (Streamlit)                         â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Overview  â”‚  â”‚  Content   â”‚  â”‚  Quality   â”‚  â”‚  Comparison  â”‚  â”‚
â”‚  â”‚    Tab     â”‚  â”‚    Tab     â”‚  â”‚    Tab     â”‚  â”‚     Tab      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â”‚  Actions: [ Approve ] [ Request Changes ] [ Reject ]                â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                     â”‚
                    â–¼                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Approved  â”‚        â”‚   Rejected   â”‚
            â”‚  Content  â”‚        â”‚  (Log & Learn)â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Data Flow

```
Competitor URL
    â”‚
    â”œâ”€â–º [Extraction] â”€â”€â–º Markdown â”€â”€â–º SQLite (stage_outputs)
    â”‚                                  â”‚
    â”‚                                  â”œâ”€â–º ChromaDB (fingerprint)
    â”‚                                  â”‚
    â”œâ”€â–º [Analysis] â”€â”€â”€â”€â–º Brief â”€â”€â”€â”€â”€â”€â–º SQLite (stage_outputs)
    â”‚                                  â”‚
    â”œâ”€â–º [Safety] â”€â”€â”€â”€â”€â”€â–º Decision â”€â”€â–º SQLite (pipelines.safety_decision)
    â”‚                                  â”‚
    â”œâ”€â–º [RAG] â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Examples â—„â”€â–º ChromaDB (brand_voice)
    â”‚                                  â”‚
    â”œâ”€â–º [Outline] â”€â”€â”€â”€â”€â–º Structure â”€â–º SQLite (stage_outputs)
    â”‚                                  â”‚
    â”œâ”€â–º [Generate] â”€â”€â”€â”€â–º Draft â”€â”€â”€â”€â”€â”€â–º Filesystem (drafts/)
    â”‚                                  â”‚
    â”œâ”€â–º [QA] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Report â”€â”€â”€â”€â”€â–º SQLite (stage_outputs)
    â”‚                                  â”‚
    â””â”€â–º [Format] â”€â”€â”€â”€â”€â”€â–º HTML â”€â”€â”€â”€â”€â”€â”€â–º Filesystem (outputs/)
                                       â”‚
                                       â””â”€â–º Dashboard â—„â”€â–º User Action
                                                          â”‚
                                                          â””â”€â–º SQLite (audit_log)
```

## ğŸ—„ï¸ Storage Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        STORAGE LAYER                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SQLite Database   â”‚    â”‚   Local Filesystem  â”‚    â”‚    ChromaDB      â”‚
â”‚   (pipeline.db)     â”‚    â”‚   (data/)           â”‚    â”‚  (vector store)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ pipelines         â”‚    â”‚ â€¢ extractions/      â”‚    â”‚ â€¢ brand_voice    â”‚
â”‚ â€¢ stage_outputs     â”‚    â”‚ â€¢ drafts/           â”‚    â”‚   collection     â”‚
â”‚ â€¢ audit_log         â”‚    â”‚ â€¢ outputs/          â”‚    â”‚                  â”‚
â”‚                     â”‚    â”‚ â€¢ fingerprints/     â”‚    â”‚ Embeddings:      â”‚
â”‚ Schema:             â”‚    â”‚ â€¢ sendmarc_blogs/   â”‚    â”‚ â€¢ 384 dimensions â”‚
â”‚ â€¢ Pipeline state    â”‚    â”‚                     â”‚    â”‚ â€¢ Metadata tags  â”‚
â”‚ â€¢ Stage results     â”‚    â”‚ File Types:         â”‚    â”‚ â€¢ Similarity     â”‚
â”‚ â€¢ Event audit       â”‚    â”‚ â€¢ .md (markdown)    â”‚    â”‚   search         â”‚
â”‚                     â”‚    â”‚ â€¢ .html (output)    â”‚    â”‚                  â”‚
â”‚ Indexes:            â”‚    â”‚ â€¢ .json (metadata)  â”‚    â”‚ Operations:      â”‚
â”‚ â€¢ pipeline_status   â”‚    â”‚ â€¢ .npy (embeddings) â”‚    â”‚ â€¢ Query by topic â”‚
â”‚ â€¢ stage_pipeline    â”‚    â”‚                     â”‚    â”‚ â€¢ Retrieve top-N â”‚
â”‚ â€¢ audit_pipeline    â”‚    â”‚                     â”‚    â”‚ â€¢ Add/update     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”Œ External Integrations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXTERNAL SERVICES                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gemini 2.0 API  â”‚     â”‚   SerpAPI        â”‚     â”‚  Jina AI Reader â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Model:           â”‚     â”‚ Service:         â”‚     â”‚ Service:        â”‚
â”‚ â€¢ gemini-2.0-    â”‚     â”‚ â€¢ Google Search  â”‚     â”‚ â€¢ r.jina.ai/    â”‚
â”‚   flash-exp      â”‚     â”‚ â€¢ Keyword data   â”‚     â”‚ â€¢ Clean content â”‚
â”‚                  â”‚     â”‚ â€¢ SERP features  â”‚     â”‚                 â”‚
â”‚ Usage:           â”‚     â”‚                  â”‚     â”‚ Usage:          â”‚
â”‚ â€¢ Stage 2: 1 callâ”‚     â”‚ Usage:           â”‚     â”‚ â€¢ Stage 1: 1 callâ”‚
â”‚ â€¢ Stage 5: 1 callâ”‚     â”‚ â€¢ Stage 2: 5 callsâ”‚     â”‚ â€¢ Fallback to   â”‚
â”‚ â€¢ Stage 6: 1 callâ”‚     â”‚ â€¢ Optional       â”‚     â”‚   Trafilatura   â”‚
â”‚ â€¢ Stage 7: 1 callâ”‚     â”‚                  â”‚     â”‚                 â”‚
â”‚                  â”‚     â”‚ Rate Limits:     â”‚     â”‚ Rate Limits:    â”‚
â”‚ Rate Limits:     â”‚     â”‚ â€¢ 100/month      â”‚     â”‚ â€¢ Generous      â”‚
â”‚ â€¢ 1500/day (free)â”‚     â”‚   (free tier)    â”‚     â”‚   (no hard cap) â”‚
â”‚                  â”‚     â”‚                  â”‚     â”‚                 â”‚
â”‚ Cost/Pipeline:   â”‚     â”‚ Cost/Pipeline:   â”‚     â”‚ Cost/Pipeline:  â”‚
â”‚ â€¢ $0.00          â”‚     â”‚ â€¢ $0.00          â”‚     â”‚ â€¢ $0.00         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Sentence-Transformers (Local)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Model: all-MiniLM-L6-v2                  â”‚
â”‚ â€¢ Local execution (no API)               â”‚
â”‚ â€¢ 384-dimensional embeddings             â”‚
â”‚ â€¢ Used for plagiarism & RAG              â”‚
â”‚ â€¢ One-time download (~80MB)              â”‚
â”‚ â€¢ CPU compatible                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ›ï¸ Configuration Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONFIGURATION FILES                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

config/prompts.yaml
â”œâ”€ content_analysis
â”‚  â”œâ”€ system: Role definition
â”‚  â””â”€ user: Task template
â”œâ”€ outline_generation
â”‚  â”œâ”€ system: Writer role
â”‚  â”œâ”€ context: Brand examples
â”‚  â””â”€ user: Outline request
â”œâ”€ full_draft_generation
â”‚  â”œâ”€ system: Senior writer
â”‚  â”œâ”€ context: Guidelines
â”‚  â””â”€ user: Draft request
â”œâ”€ fact_checking
â”‚  â””â”€ user: Claim identification
â””â”€ keyword_extraction
   â””â”€ user: Semantic keywords

config/seo_rules.yaml
â”œâ”€ thresholds
â”‚  â”œâ”€ word_count (1500-3000)
â”‚  â”œâ”€ readability (50-70 Flesch)
â”‚  â”œâ”€ keyword_density (0.5-2.5%)
â”‚  â””â”€ meta_description (150-160 chars)
â”œâ”€ validation_rules
â”‚  â”œâ”€ blocking (critical issues)
â”‚  â””â”€ warning (review items)
â””â”€ scoring
   â”œâ”€ weights (6 components)
   â””â”€ component_scores

config/brand_guidelines.yaml
â”œâ”€ brand_voice
â”‚  â”œâ”€ tone (authoritative, clear)
â”‚  â””â”€ avoid (casual, jargon)
â”œâ”€ writing_principles
â”œâ”€ content_structure
â”œâ”€ topics_of_expertise
â””â”€ competitor_sources
   â”œâ”€ high_risk (NYT, Forbes)
   â”œâ”€ medium_risk (Medium)
   â””â”€ low_risk (competitor blogs)

.env (Environment Variables)
â”œâ”€ GEMINI_API_KEY
â”œâ”€ SERPAPI_KEY (optional)
â””â”€ JINA_API_KEY (optional)
```

## ğŸ§© Module Dependencies

```
main.py (Orchestrator)
    â”‚
    â”œâ”€â”€â”€ utils/
    â”‚    â”œâ”€ llm_client.py â”€â”€â–º google.generativeai
    â”‚    â”œâ”€ db.py â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º sqlite3
    â”‚    â””â”€ validation.py â”€â–º textstat, beautifulsoup4
    â”‚
    â”œâ”€â”€â”€ stages/
    â”‚    â”œâ”€ stage1_extract.py â”€â”€â–º requests, trafilatura
    â”‚    â”œâ”€ stage2_analyze.py â”€â”€â–º llm_client, requests (SerpAPI)
    â”‚    â”œâ”€ stage3_safety.py â”€â”€â”€â–º sentence_transformers, numpy
    â”‚    â”œâ”€ stage4_rag_setup.py â–º chromadb, sentence_transformers
    â”‚    â”œâ”€ stage5_outline.py â”€â”€â–º llm_client, stage4 (RAG)
    â”‚    â”œâ”€ stage6_generate.py â”€â–º llm_client, stage4 (RAG)
    â”‚    â”œâ”€ stage7_qa.py â”€â”€â”€â”€â”€â”€â”€â–º sklearn, stage4, validation
    â”‚    â””â”€ stage8_format.py â”€â”€â”€â–º markdown, jinja2, validation
    â”‚
    â””â”€â”€â”€ config/
         â”œâ”€ prompts.yaml
         â”œâ”€ seo_rules.yaml
         â””â”€ brand_guidelines.yaml

dashboard/app.py (Streamlit UI)
    â”‚
    â”œâ”€â”€â”€ main.py (run_pipeline, get_pipeline_outputs)
    â””â”€â”€â”€ utils/db.py (database queries)
```

## ğŸ” Security & Safety Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SAFETY ARCHITECTURE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: Pre-Generation Safety (Stage 3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Copyright Risk Assessment               â”‚
â”‚ â€¢ Domain classification                 â”‚
â”‚ â€¢ High-risk sources â†’ RED               â”‚
â”‚ â€¢ Medium-risk â†’ YELLOW                  â”‚
â”‚ â€¢ Low-risk â†’ GREEN                      â”‚
â”‚                                         â”‚
â”‚ Content Fingerprinting                  â”‚
â”‚ â€¢ Generate embeddings of competitor     â”‚
â”‚ â€¢ Store for post-generation comparison  â”‚
â”‚                                         â”‚
â”‚ Sensitive Topic Detection               â”‚
â”‚ â€¢ Legal advice indicators               â”‚
â”‚ â€¢ Financial claims                      â”‚
â”‚ â€¢ Medical content                       â”‚
â”‚ â€¢ Security vulnerabilities              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  RED FLAG? HALT  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 2: Post-Generation Validation (Stage 7)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Plagiarism Detection                    â”‚
â”‚ â€¢ Chunk-level embedding comparison      â”‚
â”‚ â€¢ Cosine similarity threshold: 0.85     â”‚
â”‚ â€¢ Flag chunks >85% similar              â”‚
â”‚                                         â”‚
â”‚ Content Quality Gates                   â”‚
â”‚ â€¢ SEO score >70 (recommended)           â”‚
â”‚ â€¢ Readability 50-70 (ideal)             â”‚
â”‚ â€¢ Keyword density 0.5-2.5%              â”‚
â”‚ â€¢ Proper heading hierarchy              â”‚
â”‚                                         â”‚
â”‚ Fact Checking                           â”‚
â”‚ â€¢ LLM-based claim identification        â”‚
â”‚ â€¢ Flag unverified statistics            â”‚
â”‚ â€¢ Require source citations              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  BLOCKED? HALT   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 3: Human Review (Stage 9)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mandatory Review Triggers               â”‚
â”‚ â€¢ YELLOW/RED safety decisions           â”‚
â”‚ â€¢ Quality warnings                      â”‚
â”‚ â€¢ Sensitive topics detected             â”‚
â”‚                                         â”‚
â”‚ Approval Workflow                       â”‚
â”‚ â€¢ Approve â†’ Mark for publication        â”‚
â”‚ â€¢ Request Changes â†’ Regenerate          â”‚
â”‚ â€¢ Reject â†’ Log reason for analytics     â”‚
â”‚                                         â”‚
â”‚ Audit Trail                             â”‚
â”‚ â€¢ Reviewer identity                     â”‚
â”‚ â€¢ Decision timestamp                    â”‚
â”‚ â€¢ Metadata (scores, issues)             â”‚
â”‚ â€¢ Full pipeline history                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Monitoring & Observability

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MONITORING POINTS (MVP)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Pipeline Execution
    â”‚
    â”œâ”€â–º Stage Completion Times â”€â”€â–º Terminal logs
    â”œâ”€â–º Error Rates â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º SQLite (audit_log)
    â”œâ”€â–º Success/Failure Status â”€â”€â–º SQLite (pipelines)
    â””â”€â–º Quality Metrics â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º SQLite (pipelines.quality_score)

Database Metrics
    â”‚
    â”œâ”€â–º Total Pipelines â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º SELECT COUNT(*) FROM pipelines
    â”œâ”€â–º Success Rate â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º WHERE status = 'completed'
    â”œâ”€â–º Avg Quality Score â”€â”€â”€â”€â”€â”€â”€â–º AVG(quality_score)
    â””â”€â–º Safety Decisions â”€â”€â”€â”€â”€â”€â”€â”€â–º GROUP BY safety_decision

Content Quality
    â”‚
    â”œâ”€â–º SEO Score Distribution â”€â”€â–º stage_outputs WHERE stage = 7
    â”œâ”€â–º Plagiarism Rates â”€â”€â”€â”€â”€â”€â”€â”€â–º Max similarity scores
    â”œâ”€â–º Readability Scores â”€â”€â”€â”€â”€â”€â–º Flesch Reading Ease avg
    â””â”€â–º Approval Rates â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º audit_log WHERE event_type = 'approved'

Future Production Monitoring (Phase 2)
    â”‚
    â”œâ”€â–º CloudWatch Dashboards
    â”œâ”€â–º Lambda execution metrics
    â”œâ”€â–º API latency tracking
    â”œâ”€â–º Cost per pipeline
    â””â”€â–º Real-time alerts
```

## ğŸš€ Deployment Architecture (Current vs Future)

```
MVP (Current)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Single Machine Deployment       â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Python Process              â”‚  â”‚
â”‚  â”‚  â€¢ main.py (orchestrator)    â”‚  â”‚
â”‚  â”‚  â€¢ stages/ (sequential)      â”‚  â”‚
â”‚  â”‚  â€¢ utils/ (shared)           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Local Storage               â”‚  â”‚
â”‚  â”‚  â€¢ SQLite DB                 â”‚  â”‚
â”‚  â”‚  â€¢ Filesystem                â”‚  â”‚
â”‚  â”‚  â€¢ ChromaDB                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Streamlit Server            â”‚  â”‚
â”‚  â”‚  â€¢ dashboard/app.py          â”‚  â”‚
â”‚  â”‚  â€¢ Port 8501                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Phase 2 (Production)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AWS Cloud Architecture                   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ API        â”‚â”€â”€â”€â–ºâ”‚  Lambda Functions                â”‚   â”‚
â”‚  â”‚ Gateway    â”‚    â”‚  â€¢ stage1_extract                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â€¢ stage2_analyze                â”‚   â”‚
â”‚                    â”‚  â€¢ stage3_safety                 â”‚   â”‚
â”‚                    â”‚  â€¢ ...                           â”‚   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                   â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚           Temporal Workflow Engine             â”‚       â”‚
â”‚  â”‚           (Orchestration)                      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                   â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                â”‚                        â”‚           â”‚ â”‚
â”‚  â–¼                â–¼                        â–¼           â–¼ â”‚
â”‚  RDS           S3 Bucket             Pinecone      ECS  â”‚ â”‚
â”‚  (PostgreSQL)  (Files)               (Vectors)  (Dashboard)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“– Key Design Patterns

### 1. **Stage Pattern**
Each stage is:
- Independent module
- Accepts previous stage output
- Returns standardized output dict
- Handles own errors
- Saves state to database

### 2. **Repository Pattern**
Database abstraction:
- `db.py` wraps all SQLite operations
- Context managers for connections
- Consistent error handling
- Type hints for safety

### 3. **Strategy Pattern**
Extraction fallback:
- Primary: Jina AI Reader
- Fallback: Trafilatura
- Transparent to caller

### 4. **Template Method Pattern**
Quality scoring:
- Multiple component scorers
- Weighted aggregation
- Extensible for new metrics

### 5. **Observer Pattern**
Audit logging:
- Every significant action logged
- Event types categorized
- Metadata attachments
- Queryable history

---

**Architecture Version**: 1.0  
**Last Updated**: November 30, 2025  
**Status**: Production Ready

